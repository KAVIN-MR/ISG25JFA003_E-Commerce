<div class="container mt-4">
  <div class="d-flex justify-content-between mb-3 align-items-center">
    <h3>Product Management (Admin)</h3>
    <button class="btn btn-primary" [routerLink]="['/admin/products/new']">Add New Product</button>
  </div>
  
  <!-- Category Filter Dropdown -->
  <div class="mb-3">
    <label for="categoryFilter" class="form-label">Filter by Category:</label>
    <select class="form-select" id="categoryFilter" [(ngModel)]="selectedCategoryId" (change)="filterProductsByCategory()">
      <option [ngValue]="null">All Categories</option>
      <option *ngFor="let category of categories" [ngValue]="category.id">{{ category.name }}</option>
    </select>
  </div>
  
  <!-- Product Table -->
  <table class="table table-bordered table-striped">
    <thead class="thead-dark">
      <tr>
        <th class="align-middle">ID</th>
        <th class="align-middle">Image</th>
        <th class="align-middle">Name</th>
        <th class="align-middle">Price</th>
        <th class="align-middle">Quantity</th>
        <th class="align-middle">Active</th>
        <th class="align-middle">Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of products" [ngClass]="{'table-warning': product.quantity < 10}">
        <td class="align-middle">{{ product.id }}</td>
        <td class="align-middle">
          <img *ngIf="product.image_url" 
               [src]="product.image_url" 
               [alt]="product.name" 
               class="img-thumbnail" 
               style="width: 60px; height: 60px; object-fit: cover;"
               onerror="this.style.display='none'">
          <span *ngIf="!product.image_url" class="text-muted">No image</span>
        </td>
        <td class="align-middle">{{ product.name }}</td>
        <td class="align-middle">â‚¹{{ product.price }}</td>
        <td class="align-middle">
          {{ product.quantity }}
          <i *ngIf="product.quantity < 10" class="bi bi-exclamation-triangle-fill text-warning ms-1" title="Low stock"></i>
        </td>
        <td class="align-middle"><span class="badge" [ngClass]="{'bg-success': product.is_active, 'bg-danger': !product.is_active}">
            {{ product.is_active ? 'Yes' : 'No' }}
          </span></td>
        <td class="align-middle">
          <button class="btn btn-sm btn-info me-2" [routerLink]="['/admin/products/edit', product.id]">Edit</button>
          <button class="btn btn-sm btn-danger" (click)="onDelete(product.id)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>